# -*- coding: utf-8 -*-
"""
Spyder Editor

This is a temporary script file.
"""
import numpy as np
from astropy.table import Table

path = r"\\SKYQUERY01\Data\temp0\data0\ebanyai\TwoRXS"
data_file = path + r"\cat2rxs.fits"

data = Table.read(data_file, format='fits')
df = data.to_pandas()

df.fillna(value=-99,inplace=True)
df.rename(index=str, columns={"RA_DEG": "RA", "DEC_DEG": "DEC"},inplace=True)

types = [("IAU_NAME","S21"),
        ("SEQ_ID","i8"),
        ("IND_DET","i4"),
        ("EXI_ML","f8"),
        ("CTS","f8"),
        ("CERR","f8"),
        ("RATE","f8"),
        ("ERATE","f8"),
        ("EXPOSURE","f8"),
        ("RA","f8"),
        ("DEC","f8"),
        ("RA_HMS","S12"),
        ("DEC_DMS","S12"),
        ("LII","f8"),
        ("BII","f8"),
        ("LAMBDA","f8"),
        ("BETA","f8"),
        ("EXT","f8"),
        ("EXTERR","f8"),
        ("EXT_ML","f8"),
        ("HR_1","f8"),
        ("HR_1_err","f8"),
        ("HR_2","f8"),
        ("HR_2_err","f8"),
        ("USKY","i1"),
        ("Masked","i1"),
        ("FLAG_all","i2"),
        ("S_flag","i2"),
        ("INDEX","i8"),
        ("AMPL_MAX","f8"),
        ("CM","f8"),
        ("CD","f8"),
        ("CTS_lc","f8"),
        ("CMIN","f8"),
        ("CMAX","f8"),
        ("EMIN","f8"),
        ("EMAX","f8"),
        ("CHI2_lc","f8"),
        ("EXCESS_VAR","f8"),
        ("UNCERTAINTY","f8"),
        ("Sigma_Excess","f8"),
        ("NH_gal","f8"),
        ("NH_fit_p","f8"),
        ("NH_err_p","f8"),
        ("NORM_p","f8"),
        ("NORM_err_p","f8"),
        ("GAMMA_p","f8"),
        ("GAMMA_err_p","f8"),
        ("CTR_spec_p","f8"),
        ("FLUX_p","f8"),
        ("Chi2red_spec_p","f8"),
        ("Chi2_spec_p","f8"),
        ("Num_Data_pts_p","i2"),
        ("Num_Deg_free_p","i2"),
        ("NH_fit_m","f8"),
        ("NH_err_m","f8"),
        ("NORM_m","f8"),
        ("NORM_err_m","f8"),
        ("Temp_fit_m","f8"),
        ("Temp_err_m","f8"),
        ("CTR_spec_m","f8"),
        ("FLUX_m","f8"),
        ("Chi2red_spec_m","f8"),
        ("Chi2_spec_m","f8"),
        ("Num_Data_pts_m","i2"),
        ("Num_Deg_free_m","i2"),
        ("NH_fit_b","f8"),
        ("NH_err_b","f8"),
        ("NORM_b","f8"),
        ("NORM_err_b","f8"),
        ("Temp_fit_b","f8"),
        ("Temp_err_b","f8"),
        ("CTR_spec_b","f8"),
        ("FLUX_b","f8"),
        ("Chi2red_spec_b","f8"),
        ("Chi2_spec_b","f8"),
        ("Num_Data_pts_b","i2"),
        ("Num_Deg_free_b","i2"),
        ("X_IMA","f8"),
        ("Y_IMA","f8"),
        ("XERR","f8"),
        ("YERR","f8"),
        ("X_SKY","f8"),
        ("Y_SKY","f8"),
        ("CUT_RAD","i4"),
        ("FA","f4"),
        ("TOTNUM","f8"),
        ("BGR","f8"),
        ("VIG_COR","f8"),
        ("REMARKS","S12"),
        ("SB1","f8"),
        ("SB2","f8"),
        ("SB3","f8"),
        ("SB4","f8"),
        ("B1","f8"),
        ("B2","f8"),
        ("B3","f8"),
        ("B4","f8"),
        ("B_SPA","f8"),
        ("S1","f8"),
        ("S2","f8"),
        ("S3","f8"),
        ("S4","f8"),
        ("mult_xmmsl1","i2"),
        ("entr_xmmsl1","i4"),
        ("dist_xmmsl1","f4"),
        ("RA_xmmsl1","f8"),
        ("DEC_xmmsl1","f8"),
        ("SRCNAME_xmmsl1","S40"),
        ("RATE_B0_xmmsl1","f8"),
        ("RATE_B0e_xmmsl1","f8"),
        ("RATE_B5_xmmsl1","f8"),
        ("RATE_B5e_xmmsl1","f8"),
        ("mult_3xmm","i2"),
        ("entr_3xmm","i4"),
        ("dist_3xmm","f4"),
        ("RA_3xmm","f8"),
        ("DEC_3xmm","f8"),
        ("SRCNAME_3xmm","S21"),
        ("RATE_EP8_3xmm","f8"),
        ("RATE_EP8e_3xmm","f8"),
        ("FLUX_R_3xmm","f8"),
        ("FLUX_R_err_3xmm","f8"),
        ("mult_2rxp","i2"),
        ("entr_2rxp","i4"),
        ("dist_2rxp","f4"),
        ("RA_2rxp","f8"),
        ("DEC_2rxp","f8"),
        ("SRCNAME_2rxp","S16"),
        ("CRATE_2rxp","f8"),
        ("CRATE_err_2rxp","f8"),
        ("ExpTime_2rxp","i4"),
        ("ObsID_2rxp","S15"),
        ("mult_1rxs","i2"),
        ("entr_1rxs","i4"),
        ("dist_1rxs","f4"),
        ("RA_1rxs","f8"),
        ("DEC_1rxs","f8"),
        ("SRCNAME_1rxs","S16"),
        ("RATE_1rxs","f8"),
        ("RATE_err_1rxs","f8"),
        ("CTS_1rxs","f8"),
        ("CTS_err_1rxs","f8"),
        ("EXI_ML_1rxs","i4"),
        ("EXPOS_1rxs","i8"),
        ("HR1_1rxs","f4"),
        ("HR1e_1rxs","f4"),
        ("HR2_1rxs","f4"),
        ("HR2e_1rxs","f4"),
        ("mult_vv10","i2"),
        ("entr_vv10","i4"),
        ("dist_vv10","f4"),
        ("NAME_vv10","S17"),
        ("Type_vv10","S1"),
        ("Vmag_vv10","f4"),
        ("z_vv10","f4"),
        ("Index_vv10","i4"),
        ("RA_vv10","f8"),
        ("DEC_vv10","f8"),
        ("mult_tyc2","i2"),
        ("entr_tyc2","i4"),
        ("dist_tyc2","f4"),
        ("RA_tyc2","f8"),
        ("DEC_tyc2","f8"),
        ("RecNo_tyc2","i8"),
        ("VTmag_tyc2","f4"),
        ("BTmag_tyc2","f4"),
        ("TYC1_tyc2","i4"),
        ("TYC2_tyc2","i4"),
        ("TYC3_tyc2","i1"),
        ("mult_bri","i2"),
        ("entr_bri","i4"),
        ("dist_bri","f4"),
        ("RA_bri","f8"),
        ("DEC_bri","f8"),
        ("Vmag_bri","f4"),
        ("SpType_bri","S20"),
        ("RecNo_bri","i4"),
        ("HD_bri","i4"),
        ("mult_hmxb","i2"),
        ("entr_hmxb","i4"),
        ("dist_hmxb","f4"),
        ("RA_hmxb","f8"),
        ("DEC_hmxb","f8"),
        ("Name_hmxb","S21"),
        ("Name2_hmxb","S21"),
        ("Vmag_hmxb","f4"),
        ("mult_lmxb","i2"),
        ("entr_lmxb","i4"),
        ("dist_lmxb","f4"),
        ("RA_lmxb","f8"),
        ("DEC_lmxb","f8"),
        ("Name_lmxb","S16"),
        ("Name2_lmxb","S13"),
        ("Vmag_lmxb","f4"),
        ("mult_atnf","i2"),
        ("entr_atnf","i4"),
        ("dist_atnf","f4"),
        ("RA_atnf","f8"),
        ("DEC_atnf","f8"),
        ("Name_atnf","S16"),
        ("Type_atnf","S11"),
        ("Period_atnf","S21"),
        ("mult_fuh","i2"),
        ("entr_fuh","i4"),
        ("dist_fuh","f4"),
        ("RA_fuh","f8"),
        ("DEC_fuh","f8"),
        ("Seq_fuh","S4"),
        ("Name_fuh","S30"),
        ("mult_1sxps","i2"),
        ("entr_1sxps","i4"),
        ("dist_1sxps","f4"),
        ("RA_1sxps","f8"),
        ("DEC_1sxps","f8"),
        ("Expos_1sxps","f8"),
        ("DET_1sxps","i4"),
        ("DET0_1sxps","i4"),
        ("DET1_1sxps","i4"),
        ("DET2_1sxps","i4"),
        ("DET3_1sxps","i4"),
        ("INDEX_1sxps","i4"),
        ("Rate0_1sxps","f8"),
        ("ERate0_1sxps","f8"),
        ("mult_1rxh","i2"),
        ("entr_1rxh","i4"),
        ("dist_1rxh","f4"),
        ("RA_1rxh","f8"),
        ("DEC_1rxh","f8"),
        ("SRCNAME_1rxh","S21"),
        ("CRATE_1rxh","f8"),
        ("CRATE_err_1rxh","f8"),
        ("ExpTime_1rxh","i4"),
        ("SNR_1rxh","f4"),
        ("mult_flem","i2"),
        ("entr_flem","i4"),
        ("dist_flem","f4"),
        ("RA_flem","f8"),
        ("DEC_flem","f8"),
        ("SRCNAME_flem","S14"),
        ("Type_flem","S10"),
        ("WFC_flem","S1"),
        ("Rate_flem","f4"),
        ("e_Rate_flem","f4"),
        ("mult_wd","i2"),
        ("entr_wd","i4"),
        ("dist_wd","f4"),
        ("RA_wd","f8"),
        ("DEC_wd","f8"),
        ("SRCNAME_wd","S10"),
        ("Vmag_wd","f4"),
        ("Vsphot_wd","f4"),
        ("mult_sdss","i2"),
        ("entr_sdss","i4"),
        ("dist_sdss","f4"),
        ("RA_sdss","f8"),
        ("DEC_sdss","f8"),
        ("SDSS_NAME","S24"),
        ("LAMBDA_sdss","f8"),
        ("BETA_sdss","f8"),
        ("mult_2rxs","i2"),
        ("entr_2rxs","i4"),
        ("dist_2rxs","f4"),
        ("INDEX_2rxs","i4"),
        ("SEQ_ID_2rxs","i4"),
        ("IND_DET_2rxs","i4"),
        ("EXI_ML_2rxs","f8"),
        ("RATE_2rxs","f8"),
        ("RA_2rxs","f8"),
        ("DEC_2rxs","f8"),
        ("USKY_2rxs","i2"),
        ("FLAG_2rxs","i2"),
        ("BKG_id","i2"),
        ("X_BKG_1","f8"),
        ("Y_BKG_1","f8"),
        ("X_BKG_2","f8"),
        ("Y_BKG_2","f8"),
        ("BGR_1rxs","f8"),
        ("BGR_2rxs","f8"),
        ("LFLAG","i2"),
        ("CM6","f8"),
        ("CD6","f8"),
        ("EXCESSVAR6","f8"),
        ("UNCERTAINTY6","f8"),
        ("NBINS_A","i4"),
        ("NBINS_6","i4"),
        ("NBINS_1","i4"),
        ("NBINS_N","i4"),
        ("CMIN6","f8"),
        ("CMAX6","f8"),
        ("EMIN6","f8"),
        ("EMAX6","f8"),
        ("CTS_lc6","f8"),
        ("SIGMA_excess6","f8"),
        ("CM_plus_CD","f8"),
        ("SPX","i1"),
        ("LCX","i1"),
        ("OBS_CLOCK_1","f8"),
        ("OBS_CLOCK_2","f8"),
        ("OBS_DATE_1","S11"),
        ("OBS_UT_1","S10"),
        ("OBS_DATE_2","S11"),
        ("OBS_UT_2","S10"),
        ("IND_2RXS","i4")]
        
dt_df = np.dtype(types)
           

# CREATE A NUMPY ARRAY WITH THE PROPER DATA TYPES & WRITE INTO FILE
# set datatypes for binary format
records = np.array(df.iloc[:-1].to_records(),dtype=dt_df) 

# destination folder
dst = path+r"\TwoRXS.bin" 

# write to file
records.tofile(dst)