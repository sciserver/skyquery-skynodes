WITH q AS
(SELECT * FROM PhotoObjAll_01
 UNION ALL
 SELECT * FROM PhotoObjAll_02
 UNION ALL
 SELECT * FROM PhotoObjAll_03
 UNION ALL
 SELECT * FROM PhotoObjAll_04
 UNION ALL
 SELECT * FROM PhotoObjAll_05
 UNION ALL
 SELECT * FROM PhotoObjAll_06
 UNION ALL
 SELECT * FROM PhotoObjAll_07
 UNION ALL
 SELECT * FROM PhotoObjAll_08
 UNION ALL
 SELECT * FROM PhotoObjAll_09
 UNION ALL
 SELECT * FROM PhotoObjAll_10
 UNION ALL
 SELECT * FROM PhotoObjAll_11
 UNION ALL
 SELECT * FROM PhotoObjAll_12
 UNION ALL
 SELECT * FROM PhotoObjAll_13
 )
INSERT PhotoObjAll WITH (TABLOCK)
SELECT * FROM q





SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_01
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_02
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_03
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_04
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_05
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_06
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_07
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_08
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_09
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_10
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_11
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_12
UNION ALL
SELECT MIN(objid), MAX(objid) FROM PhotoObjAll_13



ALTER TABLE PhotoObjAll_01 ADD CONSTRAINT CK_PhotoObjAll_01
CHECK (objid < 1237651735200924423)

GO

ALTER TABLE PhotoObjAll_02 ADD CONSTRAINT CK_PhotoObjAll_02
CHECK (objid >= 1237651735200924423 AND objid < 1237655175474905492)

GO

ALTER TABLE PhotoObjAll_03 ADD CONSTRAINT CK_PhotoObjAll_03
CHECK (objid >= 1237655175474905492 AND objid < 1237657874324914248)

GO

ALTER TABLE PhotoObjAll_04 ADD CONSTRAINT CK_PhotoObjAll_04
CHECK (objid >= 1237657874324914248 AND objid < 1237660670886544392)

GO

ALTER TABLE PhotoObjAll_05 ADD CONSTRAINT CK_PhotoObjAll_05
CHECK (objid >= 1237660670886544392 AND objid < 1237662341618598877)

GO

ALTER TABLE PhotoObjAll_06 ADD CONSTRAINT CK_PhotoObjAll_06
CHECK (objid >= 1237662341618598877 AND objid <  1237663542610101540)

GO

ALTER TABLE PhotoObjAll_07 ADD CONSTRAINT CK_PhotoObjAll_07
CHECK (objid >= 1237663542610101540 AND objid < 1237666091124851262)

GO

ALTER TABLE PhotoObjAll_08 ADD CONSTRAINT CK_PhotoObjAll_08
CHECK (objid >= 1237666091124851262 AND objid <  1237667172921508069)

GO

ALTER TABLE PhotoObjAll_09 ADD CONSTRAINT CK_PhotoObjAll_09
CHECK (objid >= 1237667172921508069 AND objid < 1237668660060622206)

GO

ALTER TABLE PhotoObjAll_10 ADD CONSTRAINT CK_PhotoObjAll_10
CHECK (objid >= 1237668660060622206 AND objid < 1237671991344956035)

GO

ALTER TABLE PhotoObjAll_11 ADD CONSTRAINT CK_PhotoObjAll_11
CHECK (objid >= 1237671991344956035 AND objid < 1237676678221070961)

GO

ALTER TABLE PhotoObjAll_12 ADD CONSTRAINT CK_PhotoObjAll_12
CHECK (objid >= 1237676678221070961 AND objid < 1237680263459766494)

GO

ALTER TABLE PhotoObjAll_13 ADD CONSTRAINT CK_PhotoObjAll_13
CHECK (objid >= 1237680263459766494)

GO


ALTER TABLE [dbo].[PhotoObjAll_02]
SWITCH PARTITION 1 TO PhotoObjAll PARTITION 2




-- switch back

ALTER TABLE [dbo].[PhotoObjAll]
SWITCH PARTITION 2 TO PhotoObjAll_01